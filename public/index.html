<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JARVIS AI — Hacking BG</title>
  <style>
    /* Reset + page basics */
    html,body {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #000;
      overflow: hidden;
      color: #b9ffb9;
    }

    /* MATRIX CANVAS */
    #matrix {
      position: fixed;
      inset: 0;
      z-index: 0;
      display: block;
      background: radial-gradient(ellipse at center, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.6) 60%, #000 100%);
      filter: contrast(1.05);
    }

    /* subtle overlay scanlines for "old monitor" effect */
    #scanlines {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      background-image: linear-gradient(rgba(0,0,0,0) 50%, rgba(0,0,0,0.06) 50%);
      background-size: 100% 4px;
      mix-blend-mode: multiply;
    }

    /* Vignette */
    #vignette {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 2;
      background: radial-gradient(ellipse at center, rgba(0,255,170,0.03) 0%, rgba(0,0,0,0.45) 60%, #000 100%);
      mix-blend-mode: overlay;
    }

    /* container sits above canvas */
    .container {
      position: relative;
      z-index: 3;
      height: 100%;
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 20px;
      box-sizing: border-box;
      pointer-events: auto;
    }

    .title {
      color: #00ff9f;
      text-align: center;
      margin-bottom: 5px;
      letter-spacing: 6px;
      font-weight: 700;
      text-shadow: 0 0 10px rgba(0,255,159,0.15);
    }

    .sub {
      color: #9fffd1;
      text-align: center;
      margin-bottom: 10px;
      opacity: 0.9;
    }

    .sub span { color: #00eaff; }

    /* Chat box styling tuned for hacker vibe */
    .chat-box {
      flex: 1;
      width: 100%;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
      padding: 18px;
      background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.6));
      border: 1px solid rgba(0,255,140,0.12);
      border-radius: 12px;
      margin-bottom: 12px;
      backdrop-filter: blur(6px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.7), inset 0 0 40px rgba(0,255,140,0.02);
      color: #dfffdc;
    }

    .message {
      max-width: 90%;
      padding: 10px 14px;
      border-radius: 8px;
      word-wrap: break-word;
      display: inline-block;
      opacity: 0;
      transform: translateY(12px);
      animation: fadeIn 0.28s forwards;
      font-size: 14px;
      line-height: 1.3;
    }

    .message.user {
      align-self: flex-end;
      background: linear-gradient(90deg, rgba(0,234,255,0.12), rgba(0,200,200,0.04));
      color: #000;
      border: 1px solid rgba(0,234,255,0.12);
      box-shadow: 0 6px 18px rgba(0,234,255,0.03);
    }

    .message.ai {
      align-self: flex-start;
      background: rgba(0,0,0,0.45);
      color: #bfffc0;
      border: 1px solid rgba(0,255,140,0.06);
      text-shadow: 0 1px 0 rgba(0,0,0,0.6);
    }

    .message img { display:block; margin-top:8px; max-width:100%; border-radius:8px; }

    .input-area {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    /* Neon hacking input */
    #userInput {
      flex: 1;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid rgba(0,255,140,0.12);
      outline: none;
      font-size: 15px;
      background: rgba(0,0,0,0.7);
      color: #caffd0;
      box-shadow: 0 0 14px rgba(0,255,140,0.03);
      transition: 0.18s;
    }

    #userInput:focus {
      box-shadow: 0 0 22px rgba(0,255,140,0.12);
      background: rgba(0,0,0,0.85);
      color: #eaffea;
    }

    .input-area button {
      padding: 10px 16px;
      border-radius: 10px;
      border: none;
      background: linear-gradient(180deg,#00ff9f,#00eaff);
      color: #001010;
      font-weight: 700;
      cursor: pointer;
      letter-spacing: 0.6px;
      transition: 0.12s;
      box-shadow: 0 6px 18px rgba(0,234,255,0.08);
    }

    .input-area button:hover {
      transform: translateY(-2px);
      filter: saturate(1.05);
    }

    @keyframes fadeIn {
      to { opacity: 1; transform: translateY(0); }
    }

    /* small screens adjustments */
    @media (max-width:640px){
      .title{ font-size:18px; letter-spacing:4px;}
      .sub{ font-size:12px; }
      .chat-box{ padding:12px; border-radius:8px; }
      #userInput{ font-size:14px; padding:10px; }
    }

    /* small "terminal" top-left overlay */
    .term-badge {
      position: absolute;
      top: 18px;
      left: 18px;
      z-index: 4;
      padding: 8px 12px;
      border-radius: 8px;
      background: rgba(0,0,0,0.45);
      border: 1px solid rgba(0,255,140,0.06);
      color: #bfffc0;
      font-size: 13px;
      letter-spacing: 0.6px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.6);
    }
  </style>
</head>
<body>

<canvas id="matrix"></canvas>
<div id="scanlines"></div>
<div id="vignette"></div>

<div class="term-badge">J A R V I S • READY</div>

<div class="container">
  <h1 class="title">J A R V I S</h1>
  <p class="sub">Fully Trained by <span>SAHAL_PRO</span></p>

  <div id="chat-box" class="chat-box"></div>

  <div class="input-area">
    <input id="userInput" type="text" placeholder="Type your message..." autocomplete="off">
    <button id="sendBtn">SEND</button>
  </div>
</div>

<script>
/* MATRIX / HACKING BACKGROUND
   Draws falling hex/binary/ASCII characters similar to "Matrix" but with hex & binary feel.
   Responsive: canvas resizes with window.
*/

(() => {
  const canvas = document.getElementById('matrix');
  const ctx = canvas.getContext('2d', {alpha: true});

  // Characters used: hex digits + binary + some symbols
  const chars = ('01ABCDEF89<>/\\|@#$%&*-=+;:').split('');
  let columns = [];
  let fontSize = 16;
  let colsCount = 0;

  function resize() {
    const dpr = window.devicePixelRatio || 1;
    canvas.width = Math.floor(window.innerWidth * dpr);
    canvas.height = Math.floor(window.innerHeight * dpr);
    canvas.style.width = window.innerWidth + 'px';
    canvas.style.height = window.innerHeight + 'px';
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    // recalc font size based on width/height
    fontSize = Math.max(12, Math.min(20, Math.floor(window.innerWidth / 70)));
    ctx.font = fontSize + 'px monospace';
    colsCount = Math.floor(window.innerWidth / fontSize);
    columns = new Array(colsCount).fill(0).map(() => Math.random() * -50);
  }

  // paint frame
  function frame() {
    // fade the canvas slightly with translucent black to create trails
    ctx.fillStyle = 'rgba(0,0,0,0.12)';
    ctx.fillRect(0,0,canvas.width,canvas.height);

    for (let i = 0; i < columns.length; i++) {
      // choose a char with a probability weighted towards binary & hex digits
      const ch = chars[Math.floor(Math.random() * chars.length)];
      const x = i * fontSize;
      const y = columns[i] * fontSize;
      // bright head
      ctx.fillStyle = 'rgba(150,255,180,0.95)';
      ctx.fillText(ch, x, y);
      // faint afterglow slightly above (for depth)
      if (Math.random() < 0.2) {
        ctx.fillStyle = 'rgba(100,200,140,0.25)';
        ctx.fillText(chars[Math.floor(Math.random()*chars.length)], x, y - fontSize * 0.8);
      }
      columns[i] += 0.5 + Math.random() * 0.9; // varied speed

      // reset with small probability to create gaps & variety
      if (y > canvas.height / (window.devicePixelRatio || 1) && Math.random() > 0.975) {
        columns[i] = Math.random() * -20;
      }
    }

    requestAnimationFrame(frame);
  }

  // slight flicker effect to simulate monitor instability
  let flicker = 0;
  function flickerLoop() {
    flicker = Math.random();
    canvas.style.opacity = 0.95 + (flicker * 0.05);
    setTimeout(flickerLoop, 120 + Math.random()*380);
  }

  window.addEventListener('resize', resize);
  resize();
  flickerLoop();
  frame();
})();

/* CHAT JS - mostly kept from your file, minor tweaks for the new style */
const chatBox = document.getElementById("chat-box");
const input = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");

sendBtn.onclick = sendMessage;
input.addEventListener("keydown", e => { if(e.key==="Enter") sendMessage(); });

function addMessage(sender, text, gifUrl=null){
  const bubble = document.createElement("div");
  bubble.classList.add("message", sender==="You"?"user":"ai");

  const textEl = document.createElement("div");
  textEl.textContent = text;
  bubble.appendChild(textEl);

  if(gifUrl){
    const img = document.createElement("img");
    img.src = gifUrl;
    bubble.appendChild(img);
  }

  chatBox.appendChild(bubble);
  chatBox.scrollTop = chatBox.scrollHeight;
}

async function sendMessage(){
  const message = input.value.trim();
  if(!message) return;
  addMessage("You", message);
  input.value="";

  // Custom replies first
  let customReply = null;
  if(/who is your creator/i.test(message)) customReply="My creator is SAHAL_PRO";
  else if(/which api/i.test(message)) customReply="Fully trained by SAHAL_PRO";

  if(customReply){
    addMessage("JARVIS", customReply);
    return;
  }

  try{
    // your server endpoint - unchanged
    const res = await fetch("/ask", {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({message})
    });
    const data = await res.json();
    addMessage("JARVIS", data.reply, data.gif);
  } catch(err){
    addMessage("JARVIS","⚠ Error sending request.");
  }
}
</script>

</body>
</html>
